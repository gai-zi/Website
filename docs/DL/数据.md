---
sidebar_position: 4
---

# æ•°æ®

## æ•°æ®æ“ä½œ

:::note

Nç»´æ•°ç»„æ˜¯æœºå™¨å­¦ä¹ å’Œç¥ç»ç½‘ç»œçš„ä¸»è¦æ•°æ®ç»“æ„

:::

Nç»´æ•°ç»„æ ·ä¾‹(1)

![image-20230115151923372](./src/image-20230115151923372.png)

Nç»´æ•°ç»„æ ·ä¾‹(2)

![image-20230115152124948](./src/image-20230115152124948.png)

### åˆ›å»ºæ•°ç»„

![image-20230115152333684](./src/image-20230115152333684.png)

### è®¿é—®å…ƒç´ 

å­åŒºåŸŸ [1:3,1:] 

â€‹	 "`1:3`ä¸ºå·¦é—­å¼€åŒºé—´ï¼Œè¾“å‡º1~2è¡Œ"

å­åŒºåŸŸ[::3,::2]

â€‹	" `::` ä¸‰ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªå·¦é—­å³å¼€åŒºé—´ï¼Œç¬¬ä¸‰ä¸ªæ­¥é•¿é»˜è®¤ä¸º1"

![image-20230115152549647](./src/image-20230115152549647.png)

## æ•°æ®æ“ä½œ

$ğ‘›$ç»´æ•°ç»„ï¼Œä¹Ÿç§°ä¸º*å¼ é‡*ï¼ˆtensorï¼‰

> æ— è®ºä½¿ç”¨å“ªä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå®ƒçš„*å¼ é‡ç±»*ï¼ˆåœ¨**MXNet**ä¸­ä¸º`ndarray`ï¼Œ åœ¨**PyTorch**å’ŒTensorFlowä¸­ä¸º`Tensor`ï¼‰éƒ½ä¸**Numpy**çš„`ndarray`ç±»ä¼¼ã€‚ ä½†æ·±åº¦å­¦ä¹ æ¡†æ¶åˆæ¯”Numpyçš„`ndarray`å¤šä¸€äº›é‡è¦åŠŸèƒ½ï¼š é¦–å…ˆï¼ŒGPUå¾ˆå¥½åœ°æ”¯æŒåŠ é€Ÿè®¡ç®—ï¼Œè€ŒNumPyä»…æ”¯æŒCPUè®¡ç®—ï¼› å…¶æ¬¡ï¼Œå¼ é‡ç±»æ”¯æŒè‡ªåŠ¨å¾®åˆ†ã€‚ è¿™äº›åŠŸèƒ½ä½¿å¾—å¼ é‡ç±»æ›´é€‚åˆæ·±åº¦å­¦ä¹ ã€‚ å¦‚æœæ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬ä¹¦ä¸­æ‰€è¯´çš„å¼ é‡å‡æŒ‡çš„æ˜¯å¼ é‡ç±»çš„å®ä¾‹ã€‚

### API

ä¸è¯¦ç»†å±•å¼€ï¼Œè¯¦æƒ…æŸ¥é˜…

1. [2.1. æ•°æ®æ“ä½œ â€” åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  2.0.0 documentation (d2l.ai)](https://zh-v2.d2l.ai/chapter_preliminaries/ndarray.html)
2. [Pytorchå¸¸ç”¨APIæ±‡æ€»](https://blog.csdn.net/qq_49134563/article/details/108200828)
3. [Torch Library API â€” PyTorch master documentation](https://pytorch.org/cppdocs/library.html)

## æ•°æ®é¢„å¤„ç†

>  åœ¨Pythonä¸­å¸¸ç”¨çš„æ•°æ®åˆ†æå·¥å…·ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨`pandas`è½¯ä»¶åŒ…ã€‚ åƒåºå¤§çš„Pythonç”Ÿæ€ç³»ç»Ÿä¸­çš„è®¸å¤šå…¶ä»–æ‰©å±•åŒ…ä¸€æ ·ï¼Œ`pandas`å¯ä»¥ä¸å¼ é‡å…¼å®¹ã€‚

```python
import os
import pandas as pd

os.makedirs(os.path.join('..', 'data'), exist_ok=True)
data_file = os.path.join('..', 'data', 'house_tiny.csv')
with open(data_file, 'w') as f:
    f.write('NumRooms,Alley,Price\n')  # åˆ—å
    f.write('NA,Pave,127500\n')  # æ¯è¡Œè¡¨ç¤ºä¸€ä¸ªæ•°æ®æ ·æœ¬
    f.write('2,NA,106000\n')
    f.write('4,NA,178100\n')
    f.write('NA,NA,140000\n')

data = pd.read_csv(data_file)
print(data)
```

![image-20230115163119902](./src/image-20230115163119902.png)

### å¤„ç†ç¼ºå¤±å€¼

ä¸Šå›¾â€œ**NaN**â€é¡¹ä»£è¡¨ç¼ºå¤±å€¼ï¼Œ**ä¸ºäº†å¤„ç†ç¼ºå¤±çš„æ•°æ®ï¼Œå…¸å‹çš„æ–¹æ³•åŒ…æ‹¬<u>æ’å€¼æ³•</u>å’Œ<u>åˆ é™¤æ³•</u>**

```python
#1.
inputs, outputs = data.iloc[:, 0:2], data.iloc[:, 2]
#2.
inputs = inputs.fillna(inputs.mean())
#3.
inputs = pd.get_dummies(inputs, dummy_na=True)
#4.
x, y = torch.tensor(inputs.values), torch.tensor(outputs.values)
print(x)
print(y)
```

1. é€šè¿‡ä½ç½®ç´¢å¼•`iloc`ï¼Œæˆ‘ä»¬å°†`data`åˆ†æˆ`inputs`å’Œ`outputs`
2. `inputs.fillna`å¯¹äº`inputs`ä¸­ç¼ºå°‘çš„æ•°å€¼ï¼Œæˆ‘ä»¬ç”¨åŒä¸€åˆ—çš„å‡å€¼æ›¿æ¢â€œ`NaN`â€é¡¹
3. [**å¯¹äº`inputs`ä¸­çš„ç±»åˆ«å€¼æˆ–ç¦»æ•£å€¼ï¼Œæˆ‘ä»¬å°†â€œNaNâ€è§†ä¸ºä¸€ä¸ªç±»åˆ«ã€‚**]
   ç”±äºâ€œå··å­ç±»å‹â€ï¼ˆâ€œAlleyâ€ï¼‰åˆ—åªæ¥å—ä¸¤ç§ç±»å‹çš„ç±»åˆ«å€¼â€œPaveâ€å’Œâ€œNaNâ€ï¼Œ`pandas`å¯ä»¥è‡ªåŠ¨å°†æ­¤åˆ—è½¬æ¢ä¸ºä¸¤åˆ—â€œAlley_Paveâ€å’Œâ€œAlley_nanâ€ã€‚
   å··å­ç±»å‹ä¸ºâ€œPaveâ€çš„è¡Œä¼šå°†â€œAlley_Paveâ€çš„å€¼è®¾ç½®ä¸º1ï¼Œâ€œAlley_nanâ€çš„å€¼è®¾ç½®ä¸º0ã€‚ç¼ºå°‘å··å­ç±»å‹çš„è¡Œä¼šå°†â€œAlley_Paveâ€å’Œâ€œAlley_nanâ€åˆ†åˆ«è®¾ç½®ä¸º0å’Œ1ã€‚
4. ç°åœ¨`inputs`å’Œ`outputs`ä¸­çš„æ‰€æœ‰æ¡ç›®éƒ½æ˜¯æ•°å€¼ç±»å‹ï¼Œå®ƒä»¬å¯ä»¥è½¬æ¢ä¸ºå¼ é‡æ ¼å¼ã€‚

![image-20230115164852527](./src/image-20230115164852527.png)